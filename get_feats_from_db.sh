#!/bin/bash
SQLCMD='select Image_Metadata_CA,Image_Metadata_CCD,Image_Metadata_CCDunsc,Image_Metadata_CircArea,Image_Metadata_CircDiam,Image_Metadata_DC,Image_Metadata_DL,Image_Metadata_DT,Image_Metadata_FCP,Image_Metadata_FCPLOG,Image_Metadata_FeatSize,Image_Metadata_LA,Image_Metadata_LineArea,Image_Metadata_LineLen,Image_Metadata_NumCirc,Image_Metadata_NumLine,Image_Metadata_NumTri,Image_Metadata_ROT,Image_Metadata_RotSD,Image_Metadata_TA,Image_Metadata_TriArea,Image_Metadata_TriSize,Image_Metadata_WN0_1,Image_Metadata_WN0_2,Image_Metadata_WN0_3,Image_Metadata_WN0_4,Image_Metadata_WN0_5,Image_Metadata_WN0_7,Image_Metadata_WN1,Image_Metadata_WN1_5,Image_Metadata_WN2,Image_Metadata_WN3,Image_Metadata_WN4,Image_FileName_ALP, Image_Metadata_ArrayNumber, Image_Metadata_featureidx, median(Cells_AreaShape_Area) as Cells_AreaShape_Area,  median(Cells_AreaShape_FormFactor) as Cells_AreaShape_FormFactor, median(Nuclei_AreaShape_FormFactor) as Nuclei_AreaShape_FormFactor, count(*) as Image_Count_Cells from TiALP_Per_Image as I, TiALP_Per_Object as O where I.ImageNumber = O.ImageNumber group by I.ImageNumber'
set -x
mysql -A -u cpuser -pcPus3r -h imgdb02 2012_08_20_TopoChipScreening_deBoerLab  -e "$SQLCMD"| gsed 's/\t/,/g' > ../input/TIALP-B1/feats_from_db.csv

